import{d as R,h as p,ah as B,M,w as t,x as f,am as N,o as v,a as e,u as L,i as J,a9 as $,v as i,E as q,b as z,D as P,l as T,ap as A,c as g,F as x,aq as w,ar as G,j as H}from"./index-DQjW5cRd.js";/* empty css            *//* empty css               */import"./form-item-l0sNRNKZ.js";/* empty css              */import{getOrderDetail as K,updateOrderStatus as Q}from"./orderManagement-C0-WVVZO.js";const le=R({__name:"edit",emits:["refresh"],setup(W,{expose:E,emit:j}){const m=p(!1),y=p(),a=p({id:0,order_no:"",merchant_order_no:"",third_party_order_no:"",trace_id:"",merchant_id:"",product_id:"",channel_id:"",amount:0,fee:0,status:1,payment_method:"",notify_url:"",return_url:"",client_ip:"",user_agent:"",subject:"",body:"",extra_data:{},third_party_response:{},notify_count:0,notify_status:0,expire_time:"",paid_time:"",created_at:"",updated_at:""}),O=[{label:"待支付",value:1},{label:"支付中",value:2},{label:"支付成功",value:3},{label:"支付失败",value:4},{label:"已退款",value:5},{label:"已关闭",value:6}],k=[{label:"未通知",value:0},{label:"通知成功",value:1},{label:"通知失败",value:2}],D=async(o={})=>{if(o.id)try{const l=await K(`/api/v1/admin/order/${o.id}`),{status:_,data:n}=l.data;_&&n&&(Object.assign(a.value,n),a.value.amount=n.amount/100,a.value.fee=n.fee/100)}catch(l){f.error("获取订单详情失败: "+((l==null?void 0:l.message)||l));return}else Object.assign(a.value,{id:o.id||0,order_no:o.order_no||"",merchant_order_no:o.merchant_order_no||"",third_party_order_no:o.third_party_order_no||"",trace_id:o.trace_id||"",merchant_id:o.merchant_id||"",product_id:o.product_id||"",channel_id:o.channel_id||"",amount:o.amount?o.amount/100:0,fee:o.fee?o.fee/100:0,status:o.status??1,payment_method:o.payment_method||"",notify_url:o.notify_url||"",return_url:o.return_url||"",client_ip:o.client_ip||"",user_agent:o.user_agent||"",subject:o.subject||"",body:o.body||"",extra_data:o.extra_data||{},third_party_response:o.third_party_response||{},notify_count:o.notify_count||0,notify_status:o.notify_status??0,expire_time:o.expire_time||"",paid_time:o.paid_time||"",created_at:o.created_at||"",updated_at:o.updated_at||""});m.value=!0},I=async()=>{var d;await((d=y.value)==null?void 0:d.validate());const o={...a.value,amount:Math.round(a.value.amount*100),fee:Math.round(a.value.fee*100)},l=await Q("/api/v1/admin/order/update",o),{status:_,message:n}=l.data;_?(f.success(n||"更新成功"),C("refresh"),m.value=!1):f.error(n||"更新失败")},S=()=>{a.value={id:0,order_no:"",merchant_order_no:"",third_party_order_no:"",trace_id:"",merchant_id:"",product_id:"",channel_id:"",amount:0,fee:0,status:1,payment_method:"",notify_url:"",return_url:"",client_ip:"",user_agent:"",subject:"",body:"",extra_data:{},third_party_response:{},notify_count:0,notify_status:0,expire_time:"",paid_time:"",created_at:"",updated_at:""}};B(m,o=>{o||S()});const C=j;return E({open:D}),(o,l)=>{const _=$,n=T,d=P,r=z,s=q,V=G,b=A,U=H,F=N;return v(),M(F,{modelValue:m.value,"onUpdate:modelValue":l[23]||(l[23]=u=>m.value=u),title:"订单详情",size:"70%"},{default:t(()=>[e(L(J),{model:a.value,ref_key:"formRef",ref:y,"label-width":"150px"},{default:t(()=>[e(_,{"content-position":"left"},{default:t(()=>[...l[24]||(l[24]=[i("基本信息",-1)])]),_:1}),e(s,{gutter:20},{default:t(()=>[e(r,{span:12},{default:t(()=>[e(d,{label:"订单号"},{default:t(()=>[e(n,{modelValue:a.value.order_no,"onUpdate:modelValue":l[0]||(l[0]=u=>a.value.order_no=u),readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:t(()=>[e(d,{label:"商户订单号"},{default:t(()=>[e(n,{modelValue:a.value.merchant_order_no,"onUpdate:modelValue":l[1]||(l[1]=u=>a.value.merchant_order_no=u),readonly:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(s,{gutter:20},{default:t(()=>[e(r,{span:12},{default:t(()=>[e(d,{label:"第三方订单号"},{default:t(()=>[e(n,{modelValue:a.value.third_party_order_no,"onUpdate:modelValue":l[2]||(l[2]=u=>a.value.third_party_order_no=u),readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:t(()=>[e(d,{label:"追踪ID"},{default:t(()=>[e(n,{modelValue:a.value.trace_id,"onUpdate:modelValue":l[3]||(l[3]=u=>a.value.trace_id=u),readonly:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(s,{gutter:20},{default:t(()=>[e(r,{span:12},{default:t(()=>[e(d,{label:"商户ID"},{default:t(()=>[e(n,{modelValue:a.value.merchant_id,"onUpdate:modelValue":l[4]||(l[4]=u=>a.value.merchant_id=u),readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:t(()=>[e(d,{label:"产品ID"},{default:t(()=>[e(n,{modelValue:a.value.product_id,"onUpdate:modelValue":l[5]||(l[5]=u=>a.value.product_id=u),readonly:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(_,{"content-position":"left"},{default:t(()=>[...l[25]||(l[25]=[i("金额信息",-1)])]),_:1}),e(s,{gutter:20},{default:t(()=>[e(r,{span:12},{default:t(()=>[e(d,{label:"订单金额(元)"},{default:t(()=>[e(n,{modelValue:a.value.amount,"onUpdate:modelValue":l[6]||(l[6]=u=>a.value.amount=u),readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:t(()=>[e(d,{label:"手续费(元)"},{default:t(()=>[e(n,{modelValue:a.value.fee,"onUpdate:modelValue":l[7]||(l[7]=u=>a.value.fee=u),readonly:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(_,{"content-position":"left"},{default:t(()=>[...l[26]||(l[26]=[i("状态信息",-1)])]),_:1}),e(s,{gutter:20},{default:t(()=>[e(r,{span:12},{default:t(()=>[e(d,{label:"订单状态"},{default:t(()=>[e(b,{modelValue:a.value.status,"onUpdate:modelValue":l[8]||(l[8]=u=>a.value.status=u),disabled:a.value.status===3},{default:t(()=>[(v(),g(x,null,w(O,u=>e(V,{key:u.value,label:u.label,value:u.value},null,8,["label","value"])),64))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1}),e(r,{span:12},{default:t(()=>[e(d,{label:"通知状态"},{default:t(()=>[e(b,{modelValue:a.value.notify_status,"onUpdate:modelValue":l[9]||(l[9]=u=>a.value.notify_status=u)},{default:t(()=>[(v(),g(x,null,w(k,u=>e(V,{key:u.value,label:u.label,value:u.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(s,{gutter:20},{default:t(()=>[e(r,{span:12},{default:t(()=>[e(d,{label:"支付方式"},{default:t(()=>[e(n,{modelValue:a.value.payment_method,"onUpdate:modelValue":l[10]||(l[10]=u=>a.value.payment_method=u),readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:t(()=>[e(d,{label:"通知次数"},{default:t(()=>[e(n,{modelValue:a.value.notify_count,"onUpdate:modelValue":l[11]||(l[11]=u=>a.value.notify_count=u),readonly:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(_,{"content-position":"left"},{default:t(()=>[...l[27]||(l[27]=[i("订单内容",-1)])]),_:1}),e(d,{label:"订单标题"},{default:t(()=>[e(n,{modelValue:a.value.subject,"onUpdate:modelValue":l[12]||(l[12]=u=>a.value.subject=u),readonly:""},null,8,["modelValue"])]),_:1}),e(d,{label:"订单描述"},{default:t(()=>[e(n,{modelValue:a.value.body,"onUpdate:modelValue":l[13]||(l[13]=u=>a.value.body=u),type:"textarea",rows:3,readonly:""},null,8,["modelValue"])]),_:1}),e(_,{"content-position":"left"},{default:t(()=>[...l[28]||(l[28]=[i("回调信息",-1)])]),_:1}),e(d,{label:"通知URL"},{default:t(()=>[e(n,{modelValue:a.value.notify_url,"onUpdate:modelValue":l[14]||(l[14]=u=>a.value.notify_url=u),readonly:""},null,8,["modelValue"])]),_:1}),e(d,{label:"返回URL"},{default:t(()=>[e(n,{modelValue:a.value.return_url,"onUpdate:modelValue":l[15]||(l[15]=u=>a.value.return_url=u),readonly:""},null,8,["modelValue"])]),_:1}),e(s,{gutter:20},{default:t(()=>[e(r,{span:12},{default:t(()=>[e(d,{label:"客户端IP"},{default:t(()=>[e(n,{modelValue:a.value.client_ip,"onUpdate:modelValue":l[16]||(l[16]=u=>a.value.client_ip=u),readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:t(()=>[e(d,{label:"用户代理"},{default:t(()=>[e(n,{modelValue:a.value.user_agent,"onUpdate:modelValue":l[17]||(l[17]=u=>a.value.user_agent=u),readonly:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(_,{"content-position":"left"},{default:t(()=>[...l[29]||(l[29]=[i("时间信息",-1)])]),_:1}),e(s,{gutter:20},{default:t(()=>[e(r,{span:12},{default:t(()=>[e(d,{label:"过期时间"},{default:t(()=>[e(n,{modelValue:a.value.expire_time,"onUpdate:modelValue":l[18]||(l[18]=u=>a.value.expire_time=u),readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:t(()=>[e(d,{label:"支付时间"},{default:t(()=>[e(n,{modelValue:a.value.paid_time,"onUpdate:modelValue":l[19]||(l[19]=u=>a.value.paid_time=u),readonly:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(s,{gutter:20},{default:t(()=>[e(r,{span:12},{default:t(()=>[e(d,{label:"创建时间"},{default:t(()=>[e(n,{modelValue:a.value.created_at,"onUpdate:modelValue":l[20]||(l[20]=u=>a.value.created_at=u),readonly:""},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{span:12},{default:t(()=>[e(d,{label:"更新时间"},{default:t(()=>[e(n,{modelValue:a.value.updated_at,"onUpdate:modelValue":l[21]||(l[21]=u=>a.value.updated_at=u),readonly:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(_,{"content-position":"left"},{default:t(()=>[...l[30]||(l[30]=[i("扩展数据",-1)])]),_:1}),e(d,{label:"扩展数据"},{default:t(()=>[e(n,{value:JSON.stringify(a.value.extra_data,null,2),type:"textarea",rows:4,readonly:""},null,8,["value"])]),_:1}),e(d,{label:"第三方响应"},{default:t(()=>[e(n,{value:JSON.stringify(a.value.third_party_response,null,2),type:"textarea",rows:4,readonly:""},null,8,["value"])]),_:1}),e(d,null,{default:t(()=>[e(U,{type:"primary",onClick:I},{default:t(()=>[...l[31]||(l[31]=[i("保存修改",-1)])]),_:1}),e(U,{onClick:l[22]||(l[22]=u=>m.value=!1)},{default:t(()=>[...l[32]||(l[32]=[i("取消",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}});export{le as default};
//# sourceMappingURL=edit-bMN-J7wq.js.map
