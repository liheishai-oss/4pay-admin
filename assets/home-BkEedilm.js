const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/edit-BUMb4x3t.js","assets/index-DSzZq5R0.js","assets/index-qjTWfGgT.css","assets/product-BlsCW7ms.js","assets/edit-Dl_Njuox.css","assets/loading-oV0W9nDj.css","assets/input-number-CWqCFpc2.css","assets/pool-BiU-FeC9.js","assets/pool-wgLVE5gW.css","assets/checkbox-CXazyT-T.css","assets/alert-CF5VuMnX.css","assets/merchant-assignment-B-yvdvL2.js","assets/merchant-assignment-BFUiP4sB.css","assets/table-column-DHEyVPoW.css"])))=>i.map(i=>d[i]);
import{d as ce,g as f,L as _e,c as b,a as e,e as n,u as a,w as t,T as pe,M as B,q as me,N as fe,O as ge,P as he,o as C,av as V,Q as ve,a1 as be,x as Ce,E as ye,b as we,y as ke,z as Ee,ar as xe,at as Ve,n as r,k as Re,V as R,S as N,ai as Se,R as ze,U as De,W as Pe,X as Te,t as y,j as Fe,a8 as Ae,aL as Ue,as as Ie,aw as S,_ as Le}from"./index-DSzZq5R0.js";/* empty css                   *//* empty css               *//* empty css                     *//* empty css                 */import{u as Be}from"./table.plugin-C_WHYkfe.js";const Ne={class:"table-com-search"},$e={class:"search-header"},Me={class:"search-title"},Oe={class:"search-buttons"},je={class:"table-header ba-scroll-style"},qe={class:"table-search"},Ge={style:{width:"100%","overflow-x":"auto"},class:"table-content"},Qe={class:"pool-status"},We={class:"pool-summary"},Xe={key:0,class:"pool-channels"},He={class:"pool-tooltip"},Je={class:"table-footer"},Ke={class:"table-pagination"},Ye=ce({__name:"home",setup(Ze){const $=V(()=>S(()=>import("./edit-BUMb4x3t.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),w=f(null),z=(s={})=>{w.value&&w.value.open({...s})},M=V(()=>S(()=>import("./pool-BiU-FeC9.js"),__vite__mapDeps([7,1,2,3,8,5,9,10]))),k=f(null),D=s=>{k.value&&k.value.open(s)},O=V(()=>S(()=>import("./merchant-assignment-B-yvdvL2.js"),__vite__mapDeps([11,1,2,3,12,5,13,9,6]))),E=f(null),j=s=>{E.value&&E.value.open(s)},{handleSelectionChange:q,hasSelectedRows:G,isVisible:Q,toggleVisibility:P,loadData:W,data:p,refreshData:m,handleSizeChange:X,handleCurrentChange:H,searchParams:T,deleteRows:F,toggleSwitch:J}=Be("/api/v1/admin/product"),d=f({product_name:"",external_code:"",status:""}),x=f(!1),K=async()=>{x.value=!0;try{T.value={...d.value},await m()}catch(s){console.error("搜索失败:",s),ElMessage.error("搜索失败，请重试")}finally{x.value=!1}},Y=()=>{d.value={product_name:"",external_code:"",status:""},T.value={...d.value},m()};_e(()=>{W()});const Z=(s,l)=>{F(s,[l.id])},ee=s=>{F(s)};return(s,l)=>{const g=Re,i=me,A=Ee,h=ke,v=we,U=Ve,te=xe,le=ye,ae=Ce,oe=be,ne=fe,u=Pe,se=Te,ie=Ae,re=Ue,de=ge,ue=he;return C(),b(B,null,[e(a($),{ref_key:"editFormRef",ref:w,onRefresh:a(m)},null,8,["onRefresh"]),e(a(M),{ref_key:"poolDialogRef",ref:k,onRefresh:a(m)},null,8,["onRefresh"]),e(a(O),{ref_key:"merchantAssignmentRef",ref:E,onRefresh:a(m)},null,8,["onRefresh"]),e(pe,{name:"fade"},{default:t(()=>[ve(n("div",Ne,[e(oe,{class:"search-card",shadow:"never"},{header:t(()=>[n("div",$e,[n("span",Me,[e(g,null,{default:t(()=>[e(a(R))]),_:1}),l[6]||(l[6]=r(" 产品搜索 ",-1))]),e(i,{type:"text",onClick:a(P),class:"close-btn"},{default:t(()=>[e(g,null,{default:t(()=>[e(a(Se))]),_:1})]),_:1},8,["onClick"])])]),default:t(()=>[e(ae,{model:d.value,"label-width":"100px",class:"search-form"},{default:t(()=>[e(le,{gutter:20},{default:t(()=>[e(v,{span:6},{default:t(()=>[e(h,{label:"产品名称"},{default:t(()=>[e(A,{modelValue:d.value.product_name,"onUpdate:modelValue":l[0]||(l[0]=o=>d.value.product_name=o),placeholder:"请输入产品名称",clearable:"","prefix-icon":"Search"},null,8,["modelValue"])]),_:1})]),_:1}),e(v,{span:6},{default:t(()=>[e(h,{label:"对接编号"},{default:t(()=>[e(A,{modelValue:d.value.external_code,"onUpdate:modelValue":l[1]||(l[1]=o=>d.value.external_code=o),placeholder:"请输入对接编号",clearable:"","prefix-icon":"Document"},null,8,["modelValue"])]),_:1})]),_:1}),e(v,{span:6},{default:t(()=>[e(h,{label:"状态"},{default:t(()=>[e(te,{modelValue:d.value.status,"onUpdate:modelValue":l[2]||(l[2]=o=>d.value.status=o),placeholder:"请选择状态",clearable:"",style:{width:"100%"}},{default:t(()=>[e(U,{label:"启用",value:1}),e(U,{label:"禁用",value:0})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(v,{span:6},{default:t(()=>[e(h,null,{default:t(()=>[n("div",Oe,[e(i,{type:"primary",onClick:K,loading:x.value},{default:t(()=>[e(g,null,{default:t(()=>[e(a(R))]),_:1}),l[7]||(l[7]=r(" 搜索 ",-1))]),_:1},8,["loading"]),e(i,{onClick:Y},{default:t(()=>[e(g,null,{default:t(()=>[e(a(N))]),_:1}),l[8]||(l[8]=r(" 重置 ",-1))]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[ze,a(Q)]])]),_:1}),n("div",je,[e(i,{icon:a(N),onClick:a(m),color:"#40485b"},null,8,["icon","onClick"]),e(i,{type:"primary",icon:a(De),onClick:z},{default:t(()=>[...l[9]||(l[9]=[r("添加",-1)])]),_:1},8,["icon"]),e(i,{type:"danger",disabled:!a(G),onClick:l[3]||(l[3]=o=>ee("/api/v1/admin/product/batch-delete"))},{default:t(()=>[...l[10]||(l[10]=[r("删除",-1)])]),_:1},8,["disabled"]),n("div",qe,[e(ne,{class:"ml-4"},{default:t(()=>[e(i,{icon:a(R),onClick:a(P)},null,8,["icon","onClick"])]),_:1})])]),n("div",Ge,[e(de,{data:a(p).data,border:"",stripe:"","max-height":"600",style:{width:"100%"},onSelectionChange:a(q)},{default:t(()=>[e(u,{type:"selection",width:"40"}),e(u,{prop:"sort",label:"排序",align:"center","min-width":"80"}),e(u,{prop:"product_name",label:"产品名称",align:"center","min-width":"150"}),e(u,{prop:"external_code",label:"对接编号",align:"center","min-width":"120"}),e(u,{label:"状态",align:"center","min-width":"90"},{default:t(({row:o})=>[e(se,{modelValue:o.status,"onUpdate:modelValue":c=>o.status=c,"active-value":1,"inactive-value":0,onChange:c=>a(J)("/api/v1/admin/product/status-switch",o.id,Number(c))},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(u,{prop:"default_rate_bp",label:"默认费率",align:"center","min-width":"100"},{default:t(({row:o})=>[r(y((o.default_rate_bp/100).toFixed(2))+"%",1)]),_:1}),e(u,{label:"轮询池状态",align:"center","min-width":"200"},{default:t(({row:o})=>{var c,I,L;return[n("div",Qe,[n("div",We,[e(ie,{type:((c=o.pool_info)==null?void 0:c.total_count)>0?"success":"info",size:"small"},{default:t(()=>{var _;return[r(y(((_=o.pool_info)==null?void 0:_.summary)||"加载中..."),1)]}),_:2},1032,["type"])]),((L=(I=o.pool_info)==null?void 0:I.channels)==null?void 0:L.length)>0?(C(),b("div",Xe,[e(re,{effect:"dark",placement:"top","show-after":300},{content:t(()=>[n("div",He,[l[11]||(l[11]=n("div",{class:"tooltip-title"},"轮询池通道：",-1)),(C(!0),b(B,null,Ie(o.pool_info.channels,_=>(C(),b("div",{key:_.id,class:"tooltip-item"},y(_.display_name)+" ("+y(_.cost_rate)+"%) ",1))),128))])]),default:t(()=>[e(i,{type:"primary",size:"small",text:"",onClick:_=>D(o)},{default:t(()=>[...l[12]||(l[12]=[r(" 查看详情 ",-1)])]),_:1},8,["onClick"])]),_:2},1024)])):Fe("",!0)])]}),_:1}),e(u,{prop:"remark",label:"备注",align:"center","min-width":"150","show-overflow-tooltip":""}),e(u,{prop:"created_at",label:"创建时间",align:"center","min-width":"150"}),e(u,{label:"操作",align:"center",fixed:"right","min-width":"360"},{default:t(o=>[e(i,{size:"small",onClick:c=>z(o.row)},{default:t(()=>[...l[13]||(l[13]=[r("编辑",-1)])]),_:1},8,["onClick"]),e(i,{size:"small",type:"success",onClick:c=>D(o.row)},{default:t(()=>[...l[14]||(l[14]=[r("轮询池",-1)])]),_:1},8,["onClick"]),e(i,{size:"small",type:"warning",onClick:c=>j(o.row)},{default:t(()=>[...l[15]||(l[15]=[r("分配给商户",-1)])]),_:1},8,["onClick"]),e(i,{size:"small",type:"danger",onClick:c=>Z("/api/v1/admin/product/delete",o.row)},{default:t(()=>[...l[16]||(l[16]=[r("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"])]),n("div",Je,[n("div",Ke,[e(ue,{"current-page":a(p).current_page,"onUpdate:currentPage":l[4]||(l[4]=o=>a(p).current_page=o),"page-size":a(p).page_size,"onUpdate:pageSize":l[5]||(l[5]=o=>a(p).page_size=o),"page-sizes":[10,50,100,200],background:!0,"prev-text":"上一页","next-text":"下一页",layout:"total, sizes, prev, pager, next, jumper",total:a(p).page_total,onSizeChange:a(X),onCurrentChange:a(H)},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])])],64)}}}),st=Le(Ye,[["__scopeId","data-v-de9120ec"]]);export{st as default};
//# sourceMappingURL=home-BkEedilm.js.map
