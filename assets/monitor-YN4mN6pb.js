import{d as K,g as b,h as U,L as Q,aK as R,c as k,e as t,a as s,w as a,C as i,$ as X,a1 as Y,o as S,E as Z,b as ee,t as d,a8 as se,n as p,q as te,x as ae,j as L,y as le,z as oe,ar as ne,at as re,M as ue,as as de,ac as ie,aW as pe,_ as ce}from"./index-DSzZq5R0.js";/* empty css              *//* empty css               */const me={class:"robot-monitor"},ge={class:"card-header"},_e={class:"status-info"},ve={class:"status-item"},fe={class:"status-item"},ye={class:"status-item"},be={class:"value"},ke={class:"card-header"},Se={key:0,class:"telegram-fields"},we={class:"card-header"},Ce={class:"log-header"},Ie={class:"log-time"},Me={class:"log-content"},Te={key:0,class:"empty-log"},Ve={class:"stat-item"},We={class:"stat-value"},Ee={class:"stat-item"},xe={class:"stat-value"},Ne={class:"stat-item"},Ue={class:"stat-value"},Le={class:"stat-item"},De={class:"stat-value"},D="ws://localhost:8789",Oe=K({__name:"monitor",setup(Je){let r=null;const u=b(!1),V=b(""),l=U({groupId:"test_group_001",userId:"test_user_001",type:"telegram_message",message:"/帮助",telegramUpdate:JSON.stringify({update_id:123456789,message:{message_id:1,from:{id:123456789,is_bot:!1,first_name:"Test",last_name:"User",username:"testuser"},chat:{id:-0xe91e3b12d2,title:"Test Group",type:"supergroup"},date:Math.floor(Date.now()/1e3),text:"/帮助"}},null,2)}),_=b([]),w=b(),y=b(!0),m=U({totalMessages:0,successMessages:0,errorMessages:0,uptime:0}),E=()=>{try{r=new WebSocket(D),r.onopen=()=>{u.value=!0,V.value=new Date().toLocaleString(),g("success","WebSocket连接已建立"),i.success("WebSocket连接成功")},r.onmessage=o=>{V.value=new Date().toLocaleString(),J(o.data)},r.onclose=()=>{u.value=!1,g("warning","WebSocket连接已断开"),i.warning("WebSocket连接断开")},r.onerror=o=>{u.value=!1,g("error","WebSocket连接错误: "+o),i.error("WebSocket连接错误")}}catch(o){g("error","连接WebSocket失败: "+o),i.error("连接WebSocket失败")}},x=()=>{r&&(r.close(),r=null)},O=()=>{u.value?x():E()},J=o=>{try{const e=JSON.parse(o);g("info",JSON.stringify(e,null,2)),m.totalMessages++,(e.type==="telegram_message_result"||e.type==="group_message_result")&&(e.success?m.successMessages++:m.errorMessages++)}catch(e){g("error","解析消息失败: "+e+`
原始数据: `+o)}},h=()=>{if(!u.value){i.error("WebSocket未连接");return}if(!l.message.trim()){i.error("请输入消息内容");return}const o={type:l.type,message:l.message,group_id:l.groupId,user_id:l.userId};r==null||r.send(JSON.stringify(o)),g("sent","发送消息: "+JSON.stringify(o,null,2)),i.success("消息发送成功")},N=o=>{if(!u.value){i.error("WebSocket未连接");return}let e={};switch(o){case"help":e={type:"group_message",message:"/帮助",group_id:l.groupId,user_id:l.userId};break;case"ping":e={type:"ping"};break;case"status":e={type:"get_status"};break}r==null||r.send(JSON.stringify(e)),g("sent","发送快速命令: "+JSON.stringify(e,null,2)),i.success("快速命令发送成功")},g=(o,e)=>{_.value.push({timestamp:new Date().toLocaleString(),type:o,content:e}),_.value.length>1e3&&(_.value=_.value.slice(-500)),y.value&&X(()=>{w.value&&(w.value.scrollTop=w.value.scrollHeight)})},z=()=>{_.value=[],i.success("日志已清空")},F=()=>{y.value=!y.value,i.info(y.value?"已开启自动滚动":"已关闭自动滚动")},B=()=>{l.groupId="test_group_001",l.userId="test_user_001",l.type="group_message",l.message=""},$=o=>({success:"success",error:"danger",warning:"warning",info:"info",sent:"primary"})[o]||"info",A=o=>({success:"成功",error:"错误",warning:"警告",info:"信息",sent:"发送"})[o]||"未知",P=()=>{setInterval(()=>{m.uptime++},1e3)};return Q(()=>{E(),P()}),R(()=>{x()}),(o,e)=>{const v=te,C=se,c=ee,W=Z,I=Y,M=oe,f=le,T=re,j=ne,q=ae,G=pe;return S(),k("div",me,[e[26]||(e[26]=t("div",{class:"page-header"},[t("h1",null,"🤖 Telegram机器人消息监控"),t("p",null,"实时监控Telegram机器人消息处理状态和结果")],-1)),s(I,{class:"connection-status",shadow:"never"},{header:a(()=>[t("div",ge,[e[7]||(e[7]=t("span",null,"📡 连接状态",-1)),s(v,{type:u.value?"success":"danger",icon:u.value?"Check":"Close",onClick:O},{default:a(()=>[p(d(u.value?"已连接":"未连接"),1)]),_:1},8,["type","icon"])])]),default:a(()=>[t("div",_e,[s(W,{gutter:20},{default:a(()=>[s(c,{span:8},{default:a(()=>[t("div",{class:"status-item"},[e[8]||(e[8]=t("span",{class:"label"},"WebSocket地址:",-1)),t("span",{class:"value"},d(D))]),t("div",ve,[e[10]||(e[10]=t("span",{class:"label"},"Telegram支持:",-1)),s(C,{type:"success"},{default:a(()=>[...e[9]||(e[9]=[p("已启用",-1)])]),_:1})])]),_:1}),s(c,{span:8},{default:a(()=>[t("div",fe,[e[11]||(e[11]=t("span",{class:"label"},"连接状态:",-1)),s(C,{type:u.value?"success":"danger"},{default:a(()=>[p(d(u.value?"已连接":"未连接"),1)]),_:1},8,["type"])])]),_:1}),s(c,{span:8},{default:a(()=>[t("div",ye,[e[12]||(e[12]=t("span",{class:"label"},"最后活动:",-1)),t("span",be,d(V.value||"无"),1)])]),_:1})]),_:1})])]),_:1}),s(I,{class:"message-sender",shadow:"never"},{header:a(()=>[t("div",ke,[e[14]||(e[14]=t("span",null,"📤 发送测试消息",-1)),s(C,{type:"info"},{default:a(()=>[...e[13]||(e[13]=[p("支持Telegram群组消息",-1)])]),_:1})])]),default:a(()=>[s(q,{model:l,"label-width":"100px"},{default:a(()=>[s(W,{gutter:20},{default:a(()=>[s(c,{span:8},{default:a(()=>[s(f,{label:"群组ID"},{default:a(()=>[s(M,{modelValue:l.groupId,"onUpdate:modelValue":e[0]||(e[0]=n=>l.groupId=n),placeholder:"输入群组ID"},null,8,["modelValue"])]),_:1})]),_:1}),s(c,{span:8},{default:a(()=>[s(f,{label:"用户ID"},{default:a(()=>[s(M,{modelValue:l.userId,"onUpdate:modelValue":e[1]||(e[1]=n=>l.userId=n),placeholder:"输入用户ID"},null,8,["modelValue"])]),_:1})]),_:1}),s(c,{span:8},{default:a(()=>[s(f,{label:"消息类型"},{default:a(()=>[s(j,{modelValue:l.type,"onUpdate:modelValue":e[2]||(e[2]=n=>l.type=n),placeholder:"选择消息类型"},{default:a(()=>[s(T,{label:"Telegram消息",value:"telegram_message"}),s(T,{label:"群消息",value:"group_message"}),s(T,{label:"Ping",value:"ping"}),s(T,{label:"获取状态",value:"get_status"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),s(f,{label:"消息内容"},{default:a(()=>[s(M,{modelValue:l.message,"onUpdate:modelValue":e[3]||(e[3]=n=>l.message=n),type:"textarea",rows:3,placeholder:"输入消息内容，支持Telegram机器人命令如: /帮助, /预付+100, /下发-50, /查余额, /查成率1"},null,8,["modelValue"])]),_:1}),l.type==="telegram_message"?(S(),k("div",Se,[s(f,{label:"Telegram更新数据"},{default:a(()=>[s(M,{modelValue:l.telegramUpdate,"onUpdate:modelValue":e[4]||(e[4]=n=>l.telegramUpdate=n),type:"textarea",rows:4,placeholder:"输入Telegram Webhook更新数据 (JSON格式)"},null,8,["modelValue"])]),_:1})])):L("",!0),s(f,null,{default:a(()=>[s(v,{type:"primary",onClick:h,disabled:!u.value},{default:a(()=>[...e[15]||(e[15]=[p(" 发送消息 ",-1)])]),_:1},8,["disabled"]),s(v,{onClick:B},{default:a(()=>[...e[16]||(e[16]=[p("清空表单",-1)])]),_:1}),s(v,{type:"success",onClick:e[5]||(e[5]=n=>N("help"))},{default:a(()=>[...e[17]||(e[17]=[p("发送帮助命令",-1)])]),_:1}),s(v,{type:"warning",onClick:e[6]||(e[6]=n=>N("ping"))},{default:a(()=>[...e[18]||(e[18]=[p("发送Ping",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),s(I,{class:"message-log",shadow:"never"},{header:a(()=>[t("div",we,[e[20]||(e[20]=t("span",null,"📋 消息日志",-1)),t("div",null,[s(v,{size:"small",onClick:z},{default:a(()=>[...e[19]||(e[19]=[p("清空日志",-1)])]),_:1}),s(v,{size:"small",onClick:F},{default:a(()=>[p(d(y.value?"关闭自动滚动":"开启自动滚动"),1)]),_:1})])])]),default:a(()=>[t("div",{class:"log-container",ref_key:"logContainer",ref:w},[(S(!0),k(ue,null,de(_.value,(n,H)=>(S(),k("div",{key:H,class:ie(["log-item",n.type])},[t("div",Ce,[t("span",Ie,d(n.timestamp),1),s(C,{type:$(n.type),size:"small"},{default:a(()=>[p(d(A(n.type)),1)]),_:2},1032,["type"])]),t("div",Me,[t("pre",null,d(n.content),1)])],2))),128)),_.value.length===0?(S(),k("div",Te,[s(G,{description:"暂无消息日志"})])):L("",!0)],512)]),_:1}),s(I,{class:"statistics",shadow:"never"},{header:a(()=>[...e[21]||(e[21]=[t("div",{class:"card-header"},[t("span",null,"📊 统计信息")],-1)])]),default:a(()=>[s(W,{gutter:20},{default:a(()=>[s(c,{span:6},{default:a(()=>[t("div",Ve,[t("div",We,d(m.totalMessages),1),e[22]||(e[22]=t("div",{class:"stat-label"},"总消息数",-1))])]),_:1}),s(c,{span:6},{default:a(()=>[t("div",Ee,[t("div",xe,d(m.successMessages),1),e[23]||(e[23]=t("div",{class:"stat-label"},"成功消息",-1))])]),_:1}),s(c,{span:6},{default:a(()=>[t("div",Ne,[t("div",Ue,d(m.errorMessages),1),e[24]||(e[24]=t("div",{class:"stat-label"},"错误消息",-1))])]),_:1}),s(c,{span:6},{default:a(()=>[t("div",Le,[t("div",De,d(m.uptime),1),e[25]||(e[25]=t("div",{class:"stat-label"},"运行时间(秒)",-1))])]),_:1})]),_:1})]),_:1})])}}}),Be=ce(Oe,[["__scopeId","data-v-c44f2176"]]);export{Be as default};
//# sourceMappingURL=monitor-YN4mN6pb.js.map
