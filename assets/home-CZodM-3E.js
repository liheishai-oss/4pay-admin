import{d as X,h as V,y as Z,c as ee,a as e,e as i,u as n,w as a,T as ae,C as _,M as w,F as le,j as te,z as ne,A as oe,B as ie,aG as se,o as h,a5 as re,i as de,E as pe,b as ue,D as ce,l as me,ap as _e,ar as fe,v as s,m as he,J as E,H as I,ag as ge,G as ve,I as be,K as Ce,L as we,Y as y,g as ye}from"./index-DQjW5cRd.js";/* empty css                   *//* empty css            *//* empty css               *//* empty css              *//* empty css                     *//* empty css                 *//* empty css             *//* empty css             */import"./form-item-l0sNRNKZ.js";import{u as ke}from"./table.plugin-DtcfBVC9.js";import Ve from"./edit-DEGnCW6Z.js";/* empty css                */import"./supplier-CQrzdiXB.js";const Ee={class:"table-com-search"},xe={class:"search-header"},Se={class:"search-title"},Fe={class:"search-buttons"},ze={class:"table-header ba-scroll-style"},De={class:"table-search"},Re={style:{width:"100%","overflow-x":"auto"},class:"table-content"},Ue={class:"table-footer"},Be={class:"table-pagination"},Ie=X({__name:"home",setup(Te){const c=V(null),x=(d={})=>{console.log("准备打开编辑表单，数据:",d),c.value&&typeof c.value.open=="function"?c.value.open({...d}):console.error("EditForm 组件未正确挂载或open方法不存在！",{editFormRef:c.value,hasOpenMethod:c.value&&typeof c.value.open=="function"})},{handleSelectionChange:T,hasSelectedRows:N,isVisible:M,toggleVisibility:S,loadData:P,data:m,refreshData:g,handleSizeChange:G,handleCurrentChange:$,searchParams:F,deleteRows:z,toggleSwitch:D}=ke("/api/v1/admin/supplier"),r=V({supplier_name:"",interface_code:"",status:""}),k=V(!1),j=async()=>{k.value=!0;try{F.value={...r.value},await g()}catch(d){console.error("搜索失败:",d),ElMessage.error("搜索失败，请重试")}finally{k.value=!1}},L=()=>{r.value={supplier_name:"",interface_code:"",status:""},F.value={...r.value},g()};Z(()=>{P()});const O=(d,l)=>{z(d,[l.id])},A=d=>{z(d)};return(d,l)=>{const v=he,p=te,R=me,b=ce,C=ue,U=fe,H=_e,J=pe,K=de,Y=re,q=ne,o=Ce,B=we,Q=oe,W=ie,f=se("permission");return h(),ee(le,null,[e(Ve,{ref_key:"editFormRef",ref:c,onRefresh:n(g)},null,8,["onRefresh"]),e(ae,{name:"fade"},{default:a(()=>[_(i("div",Ee,[e(Y,{class:"search-card",shadow:"never"},{header:a(()=>[i("div",xe,[i("span",Se,[e(v,null,{default:a(()=>[e(n(E))]),_:1}),l[6]||(l[6]=s(" 供应商搜索 ",-1))]),e(p,{type:"text",onClick:n(S),class:"close-btn"},{default:a(()=>[e(v,null,{default:a(()=>[e(n(ge))]),_:1})]),_:1},8,["onClick"])])]),default:a(()=>[e(K,{model:r.value,"label-width":"100px",class:"search-form"},{default:a(()=>[e(J,{gutter:20},{default:a(()=>[e(C,{span:6},{default:a(()=>[e(b,{label:"供应商名称"},{default:a(()=>[e(R,{modelValue:r.value.supplier_name,"onUpdate:modelValue":l[0]||(l[0]=t=>r.value.supplier_name=t),placeholder:"请输入供应商名称",clearable:"","prefix-icon":"Search"},null,8,["modelValue"])]),_:1})]),_:1}),e(C,{span:6},{default:a(()=>[e(b,{label:"接口代码"},{default:a(()=>[e(R,{modelValue:r.value.interface_code,"onUpdate:modelValue":l[1]||(l[1]=t=>r.value.interface_code=t),placeholder:"请输入接口代码",clearable:"","prefix-icon":"Document"},null,8,["modelValue"])]),_:1})]),_:1}),e(C,{span:6},{default:a(()=>[e(b,{label:"状态"},{default:a(()=>[e(H,{modelValue:r.value.status,"onUpdate:modelValue":l[2]||(l[2]=t=>r.value.status=t),placeholder:"请选择状态",clearable:"",style:{width:"100%"}},{default:a(()=>[e(U,{label:"启用",value:1}),e(U,{label:"禁用",value:0})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(C,{span:6},{default:a(()=>[e(b,null,{default:a(()=>[i("div",Fe,[e(p,{type:"primary",onClick:j,loading:k.value},{default:a(()=>[e(v,null,{default:a(()=>[e(n(E))]),_:1}),l[7]||(l[7]=s(" 搜索 ",-1))]),_:1},8,["loading"]),e(p,{onClick:L},{default:a(()=>[e(v,null,{default:a(()=>[e(n(I))]),_:1}),l[8]||(l[8]=s(" 重置 ",-1))]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[ve,n(M)]])]),_:1}),i("div",ze,[_(e(p,{icon:n(I),onClick:n(g),color:"#40485b"},null,8,["icon","onClick"]),[[f,"supplier:list"]]),_((h(),w(p,{type:"primary",icon:n(be),onClick:x},{default:a(()=>[...l[9]||(l[9]=[s("添加",-1)])]),_:1},8,["icon"])),[[f,"supplier:add"]]),_((h(),w(p,{type:"danger",disabled:!n(N),onClick:l[3]||(l[3]=t=>A("/api/v1/admin/supplier/delete"))},{default:a(()=>[...l[10]||(l[10]=[s("删除",-1)])]),_:1},8,["disabled"])),[[f,"supplier:delete"]]),l[11]||(l[11]=i("div",{class:"table-statistics"},[i("span",{class:"stat-item stat-highlight"},"剩余预付=预付总额-可提余额；（每日结算：供应商群组内输入指令->供应商结算）")],-1)),i("div",De,[e(q,{class:"ml-4"},{default:a(()=>[e(p,{icon:n(E),onClick:n(S)},null,8,["icon","onClick"])]),_:1})])]),i("div",Re,[e(Q,{data:n(m).data,border:"",stripe:"","max-height":"600",style:{width:"100%"},onSelectionChange:n(T)},{default:a(()=>[e(o,{type:"selection",width:"40"}),e(o,{prop:"supplier_name",label:"供应商名称",align:"center","min-width":"150"}),e(o,{prop:"interface_code",label:"接口代码",align:"center","min-width":"150"}),e(o,{label:"状态",align:"center","min-width":"90"},{default:a(({row:t})=>[e(B,{modelValue:t.status,"onUpdate:modelValue":u=>t.status=u,"active-value":1,"inactive-value":0,onChange:u=>n(D)("/api/v1/admin/supplier/status-switch",t.id,Number(u))},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(o,{label:"预付检验",align:"center","min-width":"90"},{default:a(({row:t})=>[e(B,{modelValue:t.prepayment_check,"onUpdate:modelValue":u=>t.prepayment_check=u,"active-value":1,"inactive-value":0,onChange:u=>n(D)("/api/v1/admin/supplier/prepay-check",t.id,Number(u))},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(o,{prop:"prepayment_total",label:"预付总额(元)",align:"center","min-width":"120"},{default:a(({row:t})=>[s(y((t.prepayment_total/100).toFixed(2)),1)]),_:1}),e(o,{prop:"prepayment_remaining",label:"剩余预付(元)",align:"center","min-width":"120"},{default:a(({row:t})=>[s(y((t.prepayment_remaining/100).toFixed(2)),1)]),_:1}),e(o,{prop:"withdrawable_balance",label:"可提余额(元)",align:"center","min-width":"120"},{default:a(({row:t})=>[s(y((t.withdrawable_balance/100).toFixed(2)),1)]),_:1}),e(o,{prop:"today_receipt",label:"今日收款(元)",align:"center","min-width":"120"},{default:a(({row:t})=>[s(y((t.today_receipt/100).toFixed(2)),1)]),_:1}),e(o,{prop:"remark",label:"备注",align:"center","min-width":"150","show-overflow-tooltip":""}),e(o,{prop:"telegram_chat_id",label:"供应商群组ID",align:"center","min-width":"150"}),e(o,{label:"操作",align:"center",fixed:"right","min-width":"200"},{default:a(t=>[_((h(),w(p,{size:"small",onClick:u=>x(t.row)},{default:a(()=>[...l[12]||(l[12]=[s("编辑",-1)])]),_:1},8,["onClick"])),[[f,"supplier:edit"]]),_((h(),w(p,{size:"small",type:"danger",onClick:u=>O("/api/v1/admin/supplier/delete",t.row)},{default:a(()=>[...l[13]||(l[13]=[s("删除",-1)])]),_:1},8,["onClick"])),[[f,"supplier:delete"]])]),_:1})]),_:1},8,["data","onSelectionChange"])]),i("div",Ue,[i("div",Be,[e(W,{"current-page":n(m).current_page,"onUpdate:currentPage":l[4]||(l[4]=t=>n(m).current_page=t),"page-size":n(m).page_size,"onUpdate:pageSize":l[5]||(l[5]=t=>n(m).page_size=t),"page-sizes":[10,50,100,200],background:!0,"prev-text":"上一页","next-text":"下一页",layout:"total, sizes, prev, pager, next, jumper",total:n(m).page_total,onSizeChange:n(G),onCurrentChange:n($)},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])])],64)}}}),Qe=ye(Ie,[["__scopeId","data-v-92b04a30"]]);export{Qe as default};
//# sourceMappingURL=home-CZodM-3E.js.map
