{"version":3,"file":"config-ElHWdUeH.js","sources":["../../src/pages/system/config.vue"],"sourcesContent":["<template>\n  <div class=\"system-config-page\">\n    <!-- 遍历分组 -->\n    <el-card v-for=\"(group, groupKey) in groupedConfig\" :key=\"groupKey\" class=\"mb-4\">\n      <template #header>\n        <span>{{ groupKeyLabels[groupKey] || groupKey }}</span>\n      </template>\n\n      <el-form :model=\"group\" label-width=\"160px\">\n        <el-form-item\n            v-for=\"item in group\"\n            :key=\"item.config_key\"\n            :label=\"item.description || item.config_key\"\n        >\n          <component\n              :is=\"getInputComponent(item.config_type)\"\n              v-model=\"item.config_value\"\n              v-bind=\"getInputProps(item)\"\n          />\n        </el-form-item>\n      </el-form>\n    </el-card>\n\n    <div class=\"form-actions\">\n      <el-button type=\"primary\" @click=\"handleSubmit\">保存配置</el-button>\n      <el-button @click=\"handleReset\">重置</el-button>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { ref, reactive, onMounted } from 'vue'\nimport { ElMessage } from 'element-plus'\n\n// 分组显示标签，可按需求自定义\nconst groupKeyLabels: Record<string, string> = {\n  device_config: '设备配置',\n  auth_config: '后台登录认证配置'\n}\n\ninterface ConfigItem {\n  id: number\n  config_key: string\n  config_value: any\n  config_type: 'string' | 'int' | 'bool' | 'json'\n  description: string\n  group_key: string\n}\n\nconst configItems = ref<ConfigItem[]>([])\nconst groupedConfig = reactive<Record<string, ConfigItem[]>>({})\n\n// 获取 input 组件类型\nconst getInputComponent = (type: string) => {\n  switch (type) {\n    case 'bool':\n      return 'el-switch'\n    case 'json':\n    case 'string':\n      return 'el-input'\n    case 'int':\n      return 'el-input'\n    default:\n      return 'el-input'\n  }\n}\n\n// 获取 input props\nconst getInputProps = (item: ConfigItem) => {\n  if (item.config_type === 'json') return { type: 'textarea', rows: 3, placeholder: 'JSON 格式' }\n  if (item.config_type === 'int') return { type: 'number' }\n  return {}\n}\n\n// 模拟加载已有配置，实际用 API 替换\nonMounted(async () => {\n  // TODO: 改成你的接口，例如 GET /api/v1/admin/system/config/list\n  const res = await fetch('/api/v1/admin/system/config/list')\n  const data = await res.json()\n\n  configItems.value = data.data || []\n\n  // 按 group_key 分组\n  configItems.value.forEach(item => {\n    if (!groupedConfig[item.group_key]) groupedConfig[item.group_key] = []\n    groupedConfig[item.group_key].push(item)\n  })\n})\n\n// 保存配置\nconst handleSubmit = async () => {\n  try {\n    const payload = configItems.value.map(item => ({\n      id: item.id,\n      config_value: item.config_value\n    }))\n    // TODO: 改成你的接口，例如 POST /api/v1/admin/system/config/save\n    await fetch('/api/v1/admin/system/config/save', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(payload)\n    })\n    ElMessage.success('配置保存成功')\n  } catch (e) {\n    ElMessage.error('保存失败')\n  }\n}\n\n// 重置\nconst handleReset = () => {\n  window.location.reload()\n}\n</script>\n\n<style scoped>\n.mb-4 {\n  margin-bottom: 20px;\n}\n.form-actions {\n  margin-top: 20px;\n  text-align: center;\n}\n</style>\n"],"names":["groupKeyLabels","configItems","ref","groupedConfig","reactive","getInputComponent","type","getInputProps","item","onMounted","data","handleSubmit","payload","ElMessage","handleReset","_openBlock","_createElementBlock","_hoisted_1","_Fragment","_renderList","group","groupKey","_createBlock","_component_el_card","_createElementVNode","_toDisplayString","_createVNode","_component_el_form","_component_el_form_item","_resolveDynamicComponent","_mergeProps","$event","_hoisted_2","_component_el_button","_cache"],"mappings":"6WAmCA,MAAMA,EAAyC,CAC7C,cAAe,OACf,YAAa,UAAA,EAYTC,EAAcC,EAAkB,EAAE,EAClCC,EAAgBC,EAAuC,EAAE,EAGzDC,EAAqBC,GAAiB,CAC1C,OAAQA,EAAA,CACN,IAAK,OACH,MAAO,YACT,IAAK,OACL,IAAK,SACH,MAAO,WACT,IAAK,MACH,MAAO,WACT,QACE,MAAO,UAAA,CAEb,EAGMC,EAAiBC,GACjBA,EAAK,cAAgB,OAAe,CAAE,KAAM,WAAY,KAAM,EAAG,YAAa,SAAA,EAC9EA,EAAK,cAAgB,MAAc,CAAE,KAAM,QAAA,EACxC,CAAA,EAITC,EAAU,SAAY,CAGpB,MAAMC,EAAO,MADD,MAAM,MAAM,kCAAkC,GACnC,KAAA,EAEvBT,EAAY,MAAQS,EAAK,MAAQ,CAAA,EAGjCT,EAAY,MAAM,QAAQO,GAAQ,CAC3BL,EAAcK,EAAK,SAAS,IAAGL,EAAcK,EAAK,SAAS,EAAI,CAAA,GACpEL,EAAcK,EAAK,SAAS,EAAE,KAAKA,CAAI,CACzC,CAAC,CACH,CAAC,EAGD,MAAMG,EAAe,SAAY,CAC/B,GAAI,CACF,MAAMC,EAAUX,EAAY,MAAM,IAAIO,IAAS,CAC7C,GAAIA,EAAK,GACT,aAAcA,EAAK,YAAA,EACnB,EAEF,MAAM,MAAM,mCAAoC,CAC9C,OAAQ,OACR,QAAS,CAAE,eAAgB,kBAAA,EAC3B,KAAM,KAAK,UAAUI,CAAO,CAAA,CAC7B,EACDC,EAAU,QAAQ,QAAQ,CAC5B,MAAY,CACVA,EAAU,MAAM,MAAM,CACxB,CACF,EAGMC,EAAc,IAAM,CACxB,OAAO,SAAS,OAAA,CAClB,sCA9GE,OAAAC,EAAA,EAAAC,EA0BM,MA1BNC,EA0BM,EAxBJF,EAAA,EAAA,EAAAC,EAkBUE,EAAA,KAAAC,EAlB2BhB,EAAa,CAAjCiB,EAAOC,SAAxBC,EAkBUC,EAAA,CAlB2C,IAAKF,EAAU,MAAM,MAAA,GAC7D,SACT,IAAuD,CAAvDG,EAAuD,OAAA,KAAAC,EAA9CzB,EAAeqB,CAAQ,GAAKA,CAAQ,EAAA,CAAA,CAAA,aAG/C,IAYU,CAZVK,EAYUC,EAAA,CAZA,MAAOP,EAAO,cAAY,OAAA,aAE9B,IAAqB,QADzBJ,EAUeE,EAAA,KAAAC,EATIC,EAARZ,QADXc,EAUeM,EAAA,CARV,IAAKpB,EAAK,WACV,MAAOA,EAAK,aAAeA,EAAK,UAAA,aAEnC,IAIE,EAJFO,EAAA,EAAAO,EAIEO,EAHOxB,EAAkBG,EAAK,WAAW,GAD3CsB,EAIE,CAFW,WAAAtB,EAAK,aAAL,sBAAAuB,GAAAvB,EAAK,aAAYuB,CAAA,EAClB,CAAA,QAAA,EAAA,EAAAxB,EAAcC,CAAI,CAAA,EAAA,KAAA,GAAA,CAAA,aAAA,qBAAA,CAAA,EAAA,4EAMpCgB,EAGM,MAHNQ,EAGM,CAFJN,EAAgEO,EAAA,CAArD,KAAK,UAAW,QAAOtB,CAAA,aAAc,IAAI,CAAA,GAAAuB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAAJ,OAAI,EAAA,CAAA,WACpDR,EAA8CO,EAAA,CAAlC,QAAOnB,GAAW,WAAE,IAAE,CAAA,GAAAoB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAAF,KAAE,EAAA,CAAA"}