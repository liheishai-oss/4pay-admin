import{d as U,g as m,aj as F,i as P,w as a,C as D,ao as W,o as c,Q as h,c as w,a as l,e,ap as $,n as r,t as o,E as Q,b as q,a8 as A,j as G,O as H,W as J,aW as K,au as X,_ as Y}from"./index-DSzZq5R0.js";/* empty css                *//* empty css              *//* empty css                     *//* empty css                 */import{getOrderDetail as Z}from"./orderManagement-mutiWfAJ.js";const tt={"element-loading-text":"加载中..."},et={class:"detail-item order-no-item"},lt={class:"order-no"},at={class:"detail-item"},nt={class:"detail-item"},st={class:"detail-item"},ot={class:"detail-item"},it={class:"detail-item"},dt={class:"detail-item"},ut={class:"amount"},rt={class:"detail-item"},_t={class:"amount"},pt={class:"detail-item"},ft={class:"detail-item"},mt={class:"detail-item"},vt={class:"detail-item"},ct={class:"detail-item"},bt={class:"detail-item"},gt={class:"detail-item"},yt={class:"url-text"},wt={class:"detail-item"},xt={class:"url-text"},Tt={class:"detail-item"},Et={class:"detail-item"},Dt={class:"user-agent"},ht={class:"detail-item"},Ot={class:"detail-item"},Vt={class:"detail-item"},jt={class:"detail-item"},Ct={"element-loading-text":"加载日志中..."},It={key:0,class:"empty-logs"},Lt=U({__name:"detail",setup(Nt,{expose:O}){const v=m(!1),b=m(!1),g=m(!1),n=m({id:0,order_no:"",merchant_order_no:"",third_party_order_no:"",trace_id:"",merchant_id:"",product_id:"",channel_id:"",amount:0,fee:0,status:1,payment_method:"",notify_url:"",return_url:"",client_ip:"",user_agent:"",subject:"",body:"",extra_data:{},third_party_response:{},notify_count:0,notify_status:0,expire_time:"",paid_time:"",created_at:"",updated_at:"",product:null,channel:null}),f=m([]),V=[{label:"待支付",value:1},{label:"支付中",value:2},{label:"支付成功",value:3},{label:"支付失败",value:4},{label:"已退款",value:5},{label:"已关闭",value:6}],j=[{label:"未通知",value:0},{label:"通知成功",value:1},{label:"通知失败",value:2}],C=[{label:"系统",value:"system"},{label:"管理员",value:"admin"},{label:"商户",value:"merchant"}],I=async(i={})=>{if(i.id){b.value=!0;try{const t=await Z(`/api/v1/admin/order/${i.id}`);console.log("订单详情响应:",t);let s=null;if(t&&t.data&&(s=t.data),s)Object.assign(n.value,s),s.amount&&(n.value.amount=s.amount/100),s.fee&&(n.value.fee=s.fee/100);else{D.error("获取订单详情失败：数据格式错误");return}await L(i.id)}catch(t){D.error("获取订单详情失败: "+((t==null?void 0:t.message)||t));return}finally{b.value=!1}}v.value=!0},L=async i=>{g.value=!0;try{const s=await(await fetch(`/api/v1/admin/order/logs?order_id=${i}`)).json();console.log("订单日志响应:",s),s.code===200?f.value=s.data||[]:(console.warn("获取日志失败:",s.msg),f.value=[])}catch(t){console.error("获取日志失败:",t),f.value=[]}finally{g.value=!1}},x=i=>{const t=V.find(s=>s.value===i);return t?t.label:"未知状态"},N=i=>{const t=j.find(s=>s.value===i);return t?t.label:"未知状态"},S=i=>{const t=C.find(s=>s.value===i);return t?t.label:i},T=i=>({1:"warning",2:"primary",3:"success",4:"danger",5:"info",6:"info"})[i]||"info",M=i=>({0:"warning",1:"success",2:"danger"})[i]||"info",k=()=>{n.value={id:0,order_no:"",merchant_order_no:"",third_party_order_no:"",trace_id:"",merchant_id:"",product_id:"",channel_id:"",amount:0,fee:0,status:1,payment_method:"",notify_url:"",return_url:"",client_ip:"",user_agent:"",subject:"",body:"",extra_data:{},third_party_response:{},notify_count:0,notify_status:0,expire_time:"",paid_time:"",created_at:"",updated_at:"",product:null,channel:null},f.value=[]};return F(v,i=>{i||k()}),O({open:I}),(i,t)=>{const s=$,d=q,_=Q,y=A,p=J,B=H,z=K,R=W,E=X;return c(),P(R,{modelValue:v.value,"onUpdate:modelValue":t[0]||(t[0]=u=>v.value=u),title:"订单详情",size:"70%"},{default:a(()=>[h((c(),w("div",tt,[l(s,{"content-position":"left"},{default:a(()=>[...t[1]||(t[1]=[r("基本信息",-1)])]),_:1}),e("div",et,[t[2]||(t[2]=e("label",null,"订单号：",-1)),e("span",lt,o(n.value.order_no),1)]),e("div",at,[t[3]||(t[3]=e("label",null,"商户订单号：",-1)),e("span",null,o(n.value.merchant_order_no),1)]),l(_,{gutter:20},{default:a(()=>[l(d,{span:12},{default:a(()=>[e("div",nt,[t[4]||(t[4]=e("label",null,"第三方订单号：",-1)),e("span",null,o(n.value.third_party_order_no||"-"),1)])]),_:1}),l(d,{span:12},{default:a(()=>[e("div",st,[t[5]||(t[5]=e("label",null,"追踪ID：",-1)),e("span",null,o(n.value.trace_id||"-"),1)])]),_:1})]),_:1}),l(_,{gutter:20},{default:a(()=>[l(d,{span:12},{default:a(()=>[e("div",ot,[t[6]||(t[6]=e("label",null,"商户ID：",-1)),e("span",null,o(n.value.merchant_id),1)])]),_:1}),l(d,{span:12},{default:a(()=>[e("div",it,[t[7]||(t[7]=e("label",null,"产品ID：",-1)),e("span",null,o(n.value.product_id),1)])]),_:1})]),_:1}),l(s,{"content-position":"left"},{default:a(()=>[...t[8]||(t[8]=[r("金额信息",-1)])]),_:1}),l(_,{gutter:20},{default:a(()=>[l(d,{span:12},{default:a(()=>[e("div",dt,[t[9]||(t[9]=e("label",null,"订单金额：",-1)),e("span",ut,"¥"+o(n.value.amount.toFixed(2)),1)])]),_:1}),l(d,{span:12},{default:a(()=>[e("div",rt,[t[10]||(t[10]=e("label",null,"手续费：",-1)),e("span",_t,"¥"+o(n.value.fee.toFixed(2)),1)])]),_:1})]),_:1}),l(s,{"content-position":"left"},{default:a(()=>[...t[11]||(t[11]=[r("状态信息",-1)])]),_:1}),l(_,{gutter:20},{default:a(()=>[l(d,{span:12},{default:a(()=>[e("div",pt,[t[12]||(t[12]=e("label",null,"订单状态：",-1)),l(y,{type:T(n.value.status)},{default:a(()=>[r(o(x(n.value.status)),1)]),_:1},8,["type"])])]),_:1}),l(d,{span:12},{default:a(()=>[e("div",ft,[t[13]||(t[13]=e("label",null,"通知状态：",-1)),l(y,{type:M(n.value.notify_status)},{default:a(()=>[r(o(N(n.value.notify_status)),1)]),_:1},8,["type"])])]),_:1})]),_:1}),l(_,{gutter:20},{default:a(()=>[l(d,{span:12},{default:a(()=>{var u;return[e("div",mt,[t[14]||(t[14]=e("label",null,"支付产品：",-1)),e("span",null,o(((u=n.value.product)==null?void 0:u.product_name)||"-"),1)])]}),_:1}),l(d,{span:12},{default:a(()=>{var u;return[e("div",vt,[t[15]||(t[15]=e("label",null,"支付通道：",-1)),e("span",null,o(((u=n.value.channel)==null?void 0:u.channel_name)||"-"),1)])]}),_:1})]),_:1}),l(_,{gutter:20},{default:a(()=>[l(d,{span:12},{default:a(()=>[e("div",ct,[t[16]||(t[16]=e("label",null,"通知次数：",-1)),e("span",null,o(n.value.notify_count),1)])]),_:1})]),_:1}),l(s,{"content-position":"left"},{default:a(()=>[...t[17]||(t[17]=[r("订单内容",-1)])]),_:1}),e("div",bt,[t[18]||(t[18]=e("label",null,"订单描述：",-1)),e("span",null,o(n.value.body||"-"),1)]),l(s,{"content-position":"left"},{default:a(()=>[...t[19]||(t[19]=[r("回调信息",-1)])]),_:1}),e("div",gt,[t[20]||(t[20]=e("label",null,"通知URL：",-1)),e("span",yt,o(n.value.notify_url||"-"),1)]),e("div",wt,[t[21]||(t[21]=e("label",null,"返回URL：",-1)),e("span",xt,o(n.value.return_url||"-"),1)]),l(_,{gutter:20},{default:a(()=>[l(d,{span:12},{default:a(()=>[e("div",Tt,[t[22]||(t[22]=e("label",null,"客户端IP：",-1)),e("span",null,o(n.value.client_ip||"-"),1)])]),_:1}),l(d,{span:12},{default:a(()=>[e("div",Et,[t[23]||(t[23]=e("label",null,"用户代理：",-1)),e("span",Dt,o(n.value.user_agent||"-"),1)])]),_:1})]),_:1}),l(s,{"content-position":"left"},{default:a(()=>[...t[24]||(t[24]=[r("时间信息",-1)])]),_:1}),l(_,{gutter:20},{default:a(()=>[l(d,{span:12},{default:a(()=>[e("div",ht,[t[25]||(t[25]=e("label",null,"过期时间：",-1)),e("span",null,o(n.value.expire_time||"-"),1)])]),_:1}),l(d,{span:12},{default:a(()=>[e("div",Ot,[t[26]||(t[26]=e("label",null,"支付时间：",-1)),e("span",null,o(n.value.paid_time||"-"),1)])]),_:1})]),_:1}),l(_,{gutter:20},{default:a(()=>[l(d,{span:12},{default:a(()=>[e("div",Vt,[t[27]||(t[27]=e("label",null,"创建时间：",-1)),e("span",null,o(n.value.created_at),1)])]),_:1}),l(d,{span:12},{default:a(()=>[e("div",jt,[t[28]||(t[28]=e("label",null,"更新时间：",-1)),e("span",null,o(n.value.updated_at),1)])]),_:1})]),_:1}),l(s,{"content-position":"left"},{default:a(()=>[...t[29]||(t[29]=[r("订单流转日志",-1)])]),_:1}),h((c(),w("div",Ct,[l(B,{data:f.value,border:"",stripe:"","max-height":"400"},{default:a(()=>[l(p,{prop:"action",label:"操作动作",width:"120",align:"center"}),l(p,{prop:"description",label:"描述","min-width":"200","show-overflow-tooltip":""}),l(p,{prop:"status",label:"状态",width:"100",align:"center"},{default:a(({row:u})=>[l(y,{type:T(u.status),size:"small"},{default:a(()=>[r(o(x(u.status)),1)]),_:2},1032,["type"])]),_:1}),l(p,{prop:"operator_type",label:"操作者类型",width:"100",align:"center"},{default:a(({row:u})=>[r(o(S(u.operator_type)),1)]),_:1}),l(p,{prop:"operator_name",label:"操作者",width:"120",align:"center"}),l(p,{prop:"ip_address",label:"IP地址",width:"120",align:"center"}),l(p,{prop:"created_at",label:"操作时间",width:"160",align:"center"})]),_:1},8,["data"]),f.value.length===0?(c(),w("div",It,[l(z,{description:"暂无流转日志","image-size":80})])):G("",!0)])),[[E,g.value]])])),[[E,b.value]])]),_:1},8,["modelValue"])}}}),Ut=Y(Lt,[["__scopeId","data-v-c7e8bec8"]]);export{Ut as default};
//# sourceMappingURL=detail-DD4X2EP7.js.map
