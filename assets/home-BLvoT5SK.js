const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/edit-BH7hu9Db.js","assets/index-Cc4fVNof.js","assets/index-BhGs_Rzi.css","assets/product-BKsgvBFY.js","assets/edit-Dl_Njuox.css","assets/loading-oV0W9nDj.css","assets/input-number-CWqCFpc2.css","assets/pool-3sLmZlWU.js","assets/pool-fQyDqd18.css","assets/checkbox-CXazyT-T.css","assets/merchant-assignment-BG67fPZK.js","assets/merchant-assignment-BFUiP4sB.css","assets/table-column-DHEyVPoW.css"])))=>i.map(i=>d[i]);
import{d as ce,g as f,y as _e,c as b,a as e,e as n,u as a,w as t,T as pe,F as L,v as me,z as fe,A as ge,C as he,o as C,al as V,D as ve,a6 as be,i as Ce,E as ye,b as we,k as ke,l as Ee,ah as xe,aj as Ve,t as r,m as Re,J as R,H as $,a7 as ze,G as De,I as Se,K as Te,L as Fe,Y as y,j as Pe,X as Ae,aD as Ie,ai as Ue,am as z,_ as Be}from"./index-Cc4fVNof.js";/* empty css                   *//* empty css               *//* empty css                     *//* empty css                 */import{u as Le}from"./table.plugin-BwCM5ljf.js";const $e={class:"table-com-search"},Ne={class:"search-header"},Me={class:"search-title"},Oe={class:"search-buttons"},je={class:"table-header ba-scroll-style"},Ge={class:"table-search"},He={style:{width:"100%","overflow-x":"auto"},class:"table-content"},Je={class:"pool-status"},Ke={class:"pool-summary"},Xe={key:0,class:"pool-channels"},Ye={class:"pool-tooltip"},qe={class:"table-footer"},Qe={class:"table-pagination"},We=ce({__name:"home",setup(Ze){const N=V(()=>z(()=>import("./edit-BH7hu9Db.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),w=f(null),D=(s={})=>{w.value&&w.value.open({...s})},M=V(()=>z(()=>import("./pool-3sLmZlWU.js"),__vite__mapDeps([7,1,2,3,8,5,9]))),k=f(null),S=s=>{k.value&&k.value.open(s)},O=V(()=>z(()=>import("./merchant-assignment-BG67fPZK.js"),__vite__mapDeps([10,1,2,3,11,5,12,9,6]))),E=f(null),j=s=>{E.value&&E.value.open(s)},{handleSelectionChange:G,hasSelectedRows:H,isVisible:J,toggleVisibility:T,loadData:K,data:p,refreshData:m,handleSizeChange:X,handleCurrentChange:Y,searchParams:F,deleteRows:P,toggleSwitch:q}=Le("/api/v1/admin/product"),d=f({product_name:"",external_code:"",status:""}),x=f(!1),Q=async()=>{x.value=!0;try{F.value={...d.value},await m()}catch(s){console.error("搜索失败:",s),ElMessage.error("搜索失败，请重试")}finally{x.value=!1}},W=()=>{d.value={product_name:"",external_code:"",status:""},F.value={...d.value},m()};_e(()=>{K()});const Z=(s,l)=>{P(s,[l.id])},ee=s=>{P(s)};return(s,l)=>{const g=Re,i=me,A=Ee,h=ke,v=we,I=Ve,te=xe,le=ye,ae=Ce,oe=be,ne=fe,u=Te,se=Fe,ie=Ae,re=Ie,de=ge,ue=he;return C(),b(L,null,[e(a(N),{ref_key:"editFormRef",ref:w,onRefresh:a(m)},null,8,["onRefresh"]),e(a(M),{ref_key:"poolDialogRef",ref:k,onRefresh:a(m)},null,8,["onRefresh"]),e(a(O),{ref_key:"merchantAssignmentRef",ref:E,onRefresh:a(m)},null,8,["onRefresh"]),e(pe,{name:"fade"},{default:t(()=>[ve(n("div",$e,[e(oe,{class:"search-card",shadow:"never"},{header:t(()=>[n("div",Ne,[n("span",Me,[e(g,null,{default:t(()=>[e(a(R))]),_:1}),l[6]||(l[6]=r(" 产品搜索 ",-1))]),e(i,{type:"text",onClick:a(T),class:"close-btn"},{default:t(()=>[e(g,null,{default:t(()=>[e(a(ze))]),_:1})]),_:1},8,["onClick"])])]),default:t(()=>[e(ae,{model:d.value,"label-width":"100px",class:"search-form"},{default:t(()=>[e(le,{gutter:20},{default:t(()=>[e(v,{span:6},{default:t(()=>[e(h,{label:"产品名称"},{default:t(()=>[e(A,{modelValue:d.value.product_name,"onUpdate:modelValue":l[0]||(l[0]=o=>d.value.product_name=o),placeholder:"请输入产品名称",clearable:"","prefix-icon":"Search"},null,8,["modelValue"])]),_:1})]),_:1}),e(v,{span:6},{default:t(()=>[e(h,{label:"对接编号"},{default:t(()=>[e(A,{modelValue:d.value.external_code,"onUpdate:modelValue":l[1]||(l[1]=o=>d.value.external_code=o),placeholder:"请输入对接编号",clearable:"","prefix-icon":"Document"},null,8,["modelValue"])]),_:1})]),_:1}),e(v,{span:6},{default:t(()=>[e(h,{label:"状态"},{default:t(()=>[e(te,{modelValue:d.value.status,"onUpdate:modelValue":l[2]||(l[2]=o=>d.value.status=o),placeholder:"请选择状态",clearable:"",style:{width:"100%"}},{default:t(()=>[e(I,{label:"启用",value:1}),e(I,{label:"禁用",value:0})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(v,{span:6},{default:t(()=>[e(h,null,{default:t(()=>[n("div",Oe,[e(i,{type:"primary",onClick:Q,loading:x.value},{default:t(()=>[e(g,null,{default:t(()=>[e(a(R))]),_:1}),l[7]||(l[7]=r(" 搜索 ",-1))]),_:1},8,["loading"]),e(i,{onClick:W},{default:t(()=>[e(g,null,{default:t(()=>[e(a($))]),_:1}),l[8]||(l[8]=r(" 重置 ",-1))]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[De,a(J)]])]),_:1}),n("div",je,[e(i,{icon:a($),onClick:a(m),color:"#40485b"},null,8,["icon","onClick"]),e(i,{type:"primary",icon:a(Se),onClick:D},{default:t(()=>[...l[9]||(l[9]=[r("添加",-1)])]),_:1},8,["icon"]),e(i,{type:"danger",disabled:!a(H),onClick:l[3]||(l[3]=o=>ee("/api/v1/admin/product/batch-delete"))},{default:t(()=>[...l[10]||(l[10]=[r("删除",-1)])]),_:1},8,["disabled"]),n("div",Ge,[e(ne,{class:"ml-4"},{default:t(()=>[e(i,{icon:a(R),onClick:a(T)},null,8,["icon","onClick"])]),_:1})])]),n("div",He,[e(de,{data:a(p).data,border:"",stripe:"","max-height":"600",style:{width:"100%"},onSelectionChange:a(G)},{default:t(()=>[e(u,{type:"selection",width:"40"}),e(u,{prop:"sort",label:"排序",align:"center","min-width":"80"}),e(u,{prop:"product_name",label:"产品名称",align:"center","min-width":"150"}),e(u,{prop:"external_code",label:"对接编号",align:"center","min-width":"120"}),e(u,{label:"状态",align:"center","min-width":"90"},{default:t(({row:o})=>[e(se,{modelValue:o.status,"onUpdate:modelValue":c=>o.status=c,"active-value":1,"inactive-value":0,onChange:c=>a(q)("/api/v1/admin/product/status-switch",o.id,Number(c))},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(u,{prop:"default_rate_bp",label:"默认费率",align:"center","min-width":"100"},{default:t(({row:o})=>[r(y((o.default_rate_bp/100).toFixed(2))+"%",1)]),_:1}),e(u,{label:"轮询池状态",align:"center","min-width":"200"},{default:t(({row:o})=>{var c,U,B;return[n("div",Je,[n("div",Ke,[e(ie,{type:((c=o.pool_info)==null?void 0:c.total_count)>0?"success":"info",size:"small"},{default:t(()=>{var _;return[r(y(((_=o.pool_info)==null?void 0:_.summary)||"加载中..."),1)]}),_:2},1032,["type"])]),((B=(U=o.pool_info)==null?void 0:U.channels)==null?void 0:B.length)>0?(C(),b("div",Xe,[e(re,{effect:"dark",placement:"top","show-after":300},{content:t(()=>[n("div",Ye,[l[11]||(l[11]=n("div",{class:"tooltip-title"},"轮询池通道：",-1)),(C(!0),b(L,null,Ue(o.pool_info.channels,_=>(C(),b("div",{key:_.id,class:"tooltip-item"},y(_.display_name)+" ("+y(_.cost_rate)+"%) ",1))),128))])]),default:t(()=>[e(i,{type:"primary",size:"small",text:"",onClick:_=>S(o)},{default:t(()=>[...l[12]||(l[12]=[r(" 查看详情 ",-1)])]),_:1},8,["onClick"])]),_:2},1024)])):Pe("",!0)])]}),_:1}),e(u,{prop:"remark",label:"备注",align:"center","min-width":"150","show-overflow-tooltip":""}),e(u,{prop:"created_at",label:"创建时间",align:"center","min-width":"150"}),e(u,{label:"操作",align:"center",fixed:"right","min-width":"360"},{default:t(o=>[e(i,{size:"small",onClick:c=>D(o.row)},{default:t(()=>[...l[13]||(l[13]=[r("编辑",-1)])]),_:1},8,["onClick"]),e(i,{size:"small",type:"success",onClick:c=>S(o.row)},{default:t(()=>[...l[14]||(l[14]=[r("轮询池",-1)])]),_:1},8,["onClick"]),e(i,{size:"small",type:"warning",onClick:c=>j(o.row)},{default:t(()=>[...l[15]||(l[15]=[r("分配给商户",-1)])]),_:1},8,["onClick"]),e(i,{size:"small",type:"danger",onClick:c=>Z("/api/v1/admin/product/delete",o.row)},{default:t(()=>[...l[16]||(l[16]=[r("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"])]),n("div",qe,[n("div",Qe,[e(ue,{"current-page":a(p).current_page,"onUpdate:currentPage":l[4]||(l[4]=o=>a(p).current_page=o),"page-size":a(p).page_size,"onUpdate:pageSize":l[5]||(l[5]=o=>a(p).page_size=o),"page-sizes":[10,50,100,200],background:!0,"prev-text":"上一页","next-text":"下一页",layout:"total, sizes, prev, pager, next, jumper",total:a(p).page_total,onSizeChange:a(X),onCurrentChange:a(Y)},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])])],64)}}}),st=Be(We,[["__scopeId","data-v-de9120ec"]]);export{st as default};
//# sourceMappingURL=home-BLvoT5SK.js.map
