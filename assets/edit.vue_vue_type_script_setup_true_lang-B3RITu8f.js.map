{"version":3,"file":"edit.vue_vue_type_script_setup_true_lang-B3RITu8f.js","sources":["../../src/pages/admin/rule/edit.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport {ref} from 'vue'\nimport { Search } from '@element-plus/icons-vue'\nimport {editRule, getUserRule} from \"@/api/api.ts\";\nimport {addRule} from \"@/api/api.ts\";\nimport {ElMessage} from \"element-plus\";\nconst visible = ref(false);\n// 表单数据\nconst form = ref({\n  id:0,\n  title: '',\n  rule: '',\n  parent_id: '', // 默认选中“顶级菜单”\n  is_menu: 0,\n  weight: 0,\n  status: 1,\n  remark: '',\n  path: '',\n  icon: ''\n})\nconst treeData = ref([])\nconst GetUserRule = async () => {\n  try {\n    const { data } = await getUserRule()\n    treeData.value = data || []\n  } catch (error) {\n    console.error('获取用户权限失败:', error)\n  }\n}\n\n// 配置树形结构的字段\nconst treeProps = {\n  label: 'title',\n  children: 'children'\n}\n// 定义 emit 事件\nconst emit = defineEmits<{\n  (event: 'refresh'): void;\n}>();\n// 打开弹窗并填充数据\nconst open = (data = {}) => {\n  console.log(\"接收参数\",data)\n\n  const merged = {\n    ...data,\n  };\n\n  if ((merged as any).parent_id === 0) {\n    (merged as any).parent_id = '';\n  }\n\n  Object.assign(form.value, merged);\n  GetUserRule()\n\n  visible.value = true;\n};\n// 提交表单\nconst handleSubmit = async () => {\n  let data;\n  if(form.value.id == 0) {\n    data = await addRule(form.value);\n  }else{\n    data = await editRule(form.value);\n  }\n\n    if (data.status) {\n      ElMessage.success((data as any).message)\n      emit('refresh');\n      visible.value = false;\n    }\n    return false;\n\n}\n// 暴露 `open` 方法，供外部调用\ndefineExpose({ open });\n</script>\n\n<template>\n  <el-dialog v-model=\"visible\" title=\"权限规则\" width=\"40%\">\n    <el-form :model=\"form\" label-width=\"100px\">\n      <!-- 权限名称 -->\n      <el-form-item label=\"权限名称\" prop=\"title\">\n        <el-input v-model=\"form.title\" placeholder=\"请输入权限名称\" />\n      </el-form-item>\n\n      <!-- 权限标识 -->\n      <el-form-item label=\"权限标识\" prop=\"rule\">\n        <el-input v-model=\"form.rule\" placeholder=\"如：user:create\" />\n      </el-form-item>\n\n      <!-- 上级权限（单选树形） -->\n      <el-form-item label=\"上级权限\" prop=\"parent_id\">\n        <el-tree-select\n            v-model=\"form.parent_id\"\n            :data=\"treeData\"\n            :props=\"treeProps\"\n            node-key=\"id\"\n            check-strictly\n            default-expand-all\n            placeholder=\"请选择上级权限\"\n            clearable\n            :filterable=\"true\"\n            :allow-create=\"true\"\n            default-value=\"0\"\n        />\n      </el-form-item>\n\n      <!-- 是否菜单 -->\n      <el-form-item label=\"是否菜单\" prop=\"is_menu\">\n        <el-radio-group v-model=\"form.is_menu\">\n          <el-radio :value=\"1\">是</el-radio>\n          <el-radio :value=\"0\">否</el-radio>\n        </el-radio-group>\n      </el-form-item>\n\n\n      <!-- 状态 -->\n      <el-form-item label=\"状态\" prop=\"status\">\n        <el-switch v-model=\"form.status\" :active-value=\"1\" :inactive-value=\"0\" />\n      </el-form-item>\n\n      <!-- 前端路径 -->\n      <el-form-item label=\"前端路径\" v-if=\"form.is_menu === 1\"  prop=\"path\">\n        <el-input v-model=\"form.path\" placeholder=\"如：/user/list\" />\n      </el-form-item>\n\n      <!-- 图标 -->\n      <el-form-item label=\"显示图标\" v-if=\"form.is_menu === 1\"  prop=\"icon\">\n        <el-input\n            style=\"max-width: 600px\"\n            placeholder=\"搜索图标\"\n        >\n          <template #prepend>\n            fa fa-circle-o\n          </template>\n          <template #append>\n            <el-button :icon=\"Search\" />\n          </template>\n        </el-input>\n      </el-form-item>\n      <!-- 权重 -->\n      <el-form-item label=\"权重\" prop=\"weight\">\n        <el-input-number v-model=\"form.weight\" :min=\"0\" />\n      </el-form-item>\n\n      <!-- 备注 -->\n      <el-form-item label=\"备注\" prop=\"remark\">\n        <el-input v-model=\"form.remark\" type=\"textarea\" />\n      </el-form-item>\n\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"handleSubmit\">提交</el-button>\n      </el-form-item>\n    </el-form>\n  </el-dialog>\n</template>\n"],"names":["visible","ref","form","treeData","GetUserRule","data","getUserRule","error","treeProps","emit","__emit","open","merged","handleSubmit","addRule","editRule","ElMessage","__expose","_createBlock","_component_el_dialog","$event","_createVNode","_component_el_form","_component_el_form_item","_component_el_input","_cache","_component_el_tree_select","_component_el_radio_group","_component_el_radio","_component_el_switch","_component_el_button","_unref","Search","_component_el_input_number"],"mappings":"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"}