{"version":3,"file":"edit-DVdRI5eR.js","sources":["../../src/pages/system/admin-log/edit.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { ref, watch } from 'vue'\nimport { ElMessage, ElForm } from 'element-plus'\nimport { saveData, getDetail } from '@/api/api.ts'\n\nconst visible = ref(false)\nconst formRef = ref<InstanceType<typeof ElForm>>()\n\nconst form = ref({\n  id: 0,\n  name: '',\n  weight: 0\n})\n\nconst rules = ref({\n  name: [{ required: true, message: '请输入名称'}],\n})\n\nconst emit = defineEmits<{\n  (event: 'refresh'): void\n}>()\n\n// 打开弹窗，支持传入 id，id 不为 0 时请求详情渲染数据\nconst open = async (data: { id: number }) => {\n\tconsole.log(\"详情\",data)\n  visible.value = true\n\n  if (data.id && data.id !== 0) {\n    // 请求详情\n    const res = await getDetail('/api/v1/admin/product_type/detail', data.id)\n    if (res.status && res.data) {\n      form.value = { ...res.data }\n    } else {\n      ElMessage.error(res.message || '获取数据失败')\n    }\n  } else {\n    // 新增时清空表单\n    resetForm()\n    form.value.id = 0\n  }\n}\n\nconst handleSubmit = async () => {\n  await formRef.value?.validate()\n\n  const res = await saveData(\"/api/v1/admin/product_type/save\", form.value)\n  if (res.status) {\n    ElMessage.success(res.message)\n    emit('refresh')\n    visible.value = false\n  } else {\n    ElMessage.error(res.message || '保存失败')\n  }\n}\n\nconst resetForm = () => {\n  form.value = {\n    id: 0,\n    name: '',\n    weight: 0\n  }\n}\n\nwatch(visible, (newVal) => {\n  if (!newVal) {\n    resetForm()\n  }\n})\n\ndefineExpose({ open })\n</script>\n\n<template>\n  <el-dialog v-model=\"visible\" title=\"添加/编辑产品类型\" width=\"40%\">\n    <el-form :model=\"form\" label-width=\"100px\" :rules=\"rules\" ref=\"formRef\">\n      <el-form-item label=\"类型名称\" prop=\"name\">\n        <el-input v-model=\"form.name\" placeholder=\"请输入类型名称\" />\n      </el-form-item>\n  <el-form-item label=\"是否启用\" prop=\"status\">\n        <el-switch v-model=\"form.status\" :active-value=\"1\" :inactive-value=\"0\" />\n      </el-form-item>\n      <el-form-item label=\"权重\" prop=\"weight\">\n        <el-input-number v-model=\"form.weight\" :min=\"0\" />\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"handleSubmit\">提交</el-button>\n        <el-button @click=\"resetForm\">重置</el-button>\n      </el-form-item>\n    </el-form>\n  </el-dialog>\n</template>\n"],"names":["visible","ref","formRef","form","rules","emit","__emit","open","data","res","getDetail","ElMessage","resetForm","handleSubmit","_a","saveData","watch","newVal","__expose","_createBlock","_component_el_dialog","$event","_createVNode","_unref","ElForm","_component_el_form_item","_component_el_input","_cache","_component_el_switch","_component_el_input_number","_component_el_button"],"mappings":"mRAKA,MAAMA,EAAUC,EAAI,EAAK,EACnBC,EAAUD,EAAA,EAEVE,EAAOF,EAAI,CACf,GAAI,EACJ,KAAM,GACN,OAAQ,CAAA,CACT,EAEKG,EAAQH,EAAI,CAChB,KAAM,CAAC,CAAE,SAAU,GAAM,QAAS,QAAQ,CAAA,CAC3C,EAEKI,EAAOC,EAKPC,EAAO,MAAOC,GAAyB,CAI3C,GAHD,QAAQ,IAAI,KAAKA,CAAI,EACpBR,EAAQ,MAAQ,GAEZQ,EAAK,IAAMA,EAAK,KAAO,EAAG,CAE5B,MAAMC,EAAM,MAAMC,EAAU,oCAAqCF,EAAK,EAAE,EACpEC,EAAI,QAAUA,EAAI,KACpBN,EAAK,MAAQ,CAAE,GAAGM,EAAI,IAAA,EAEtBE,EAAU,MAAMF,EAAI,SAAW,QAAQ,CAE3C,MAEEG,EAAA,EACAT,EAAK,MAAM,GAAK,CAEpB,EAEMU,EAAe,SAAY,OAC/B,OAAMC,EAAAZ,EAAQ,QAAR,YAAAY,EAAe,YAErB,MAAML,EAAM,MAAMM,EAAS,kCAAmCZ,EAAK,KAAK,EACpEM,EAAI,QACNE,EAAU,QAAQF,EAAI,OAAO,EAC7BJ,EAAK,SAAS,EACdL,EAAQ,MAAQ,IAEhBW,EAAU,MAAMF,EAAI,SAAW,MAAM,CAEzC,EAEMG,EAAY,IAAM,CACtBT,EAAK,MAAQ,CACX,GAAI,EACJ,KAAM,GACN,OAAQ,CAAA,CAEZ,EAEA,OAAAa,EAAMhB,EAAUiB,GAAW,CACpBA,GACHL,EAAA,CAEJ,CAAC,EAEDM,EAAa,CAAE,KAAAX,EAAM,mDAInBY,EAgBYC,EAAA,YAhBQpB,EAAA,2CAAAA,EAAO,MAAAqB,GAAE,MAAM,YAAY,MAAM,KAAA,aACnD,IAcU,CAdVC,EAcUC,EAAAC,CAAA,EAAA,CAdA,MAAOrB,EAAA,MAAM,cAAY,QAAS,MAAOC,EAAA,cAAW,UAAJ,IAAIF,CAAA,aAC5D,IAEe,CAFfoB,EAEeG,EAAA,CAFD,MAAM,OAAO,KAAK,MAAA,aAC9B,IAAsD,CAAtDH,EAAsDI,EAAA,CAAnC,WAAAvB,EAAA,MAAK,KAAL,sBAAAwB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAN,GAAAlB,EAAA,MAAK,KAAIkB,GAAE,YAAY,SAAA,iCAEhDC,EAEmBG,EAAA,CAFL,MAAM,OAAO,KAAK,QAAA,aAC1B,IAAyE,CAAzEH,EAAyEM,EAAA,CAArD,WAAAzB,EAAA,MAAK,OAAL,sBAAAwB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAN,GAAAlB,EAAA,MAAK,OAAMkB,GAAG,eAAc,EAAI,iBAAgB,CAAA,iCAEtEC,EAEeG,EAAA,CAFD,MAAM,KAAK,KAAK,QAAA,aAC5B,IAAkD,CAAlDH,EAAkDO,EAAA,CAAxB,WAAA1B,EAAA,MAAK,OAAL,sBAAAwB,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAN,GAAAlB,EAAA,MAAK,OAAMkB,GAAG,IAAK,CAAA,iCAE/CC,EAGeG,EAAA,KAAA,WAFb,IAA8D,CAA9DH,EAA8DQ,EAAA,CAAnD,KAAK,UAAW,QAAOjB,CAAA,aAAc,IAAE,CAAA,GAAAc,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAAF,KAAE,EAAA,CAAA,WAClDL,EAA4CQ,EAAA,CAAhC,QAAOlB,GAAS,WAAE,IAAE,CAAA,GAAAe,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,GAAF,KAAE,EAAA,CAAA"}