import{d as Y,g as V,L as Z,c as ee,a as e,e as s,u as n,w as a,T as ae,Q as m,i as C,M as le,q as te,N as ne,O as oe,P as se,aG as ie,o as h,a1 as re,x as de,E as pe,b as ue,y as ce,z as _e,ar as me,at as fe,n as i,k as he,V as x,S as N,ai as ge,R as ve,U as be,W as we,X as Ce,t as y,_ as ye}from"./index-BpE__OAv.js";/* empty css                   *//* empty css               *//* empty css                     *//* empty css                 */import{u as ke}from"./table.plugin-Bt-SOtMT.js";import Ve from"./edit-CQ7D1Eyr.js";/* empty css                *//* empty css             */import"./supplier-kp2OnSbJ.js";const xe={class:"table-com-search"},Ee={class:"search-header"},Se={class:"search-title"},Fe={class:"search-buttons"},ze={class:"table-header ba-scroll-style"},De={class:"table-search"},Re={style:{width:"100%","overflow-x":"auto"},class:"table-content"},Ue={class:"table-footer"},Be={class:"table-pagination"},Ne=Y({__name:"home",setup(Te){const c=V(null),E=(d={})=>{console.log("准备打开编辑表单，数据:",d),c.value&&typeof c.value.open=="function"?c.value.open({...d}):console.error("EditForm 组件未正确挂载或open方法不存在！",{editFormRef:c.value,hasOpenMethod:c.value&&typeof c.value.open=="function"})},{handleSelectionChange:T,hasSelectedRows:I,isVisible:P,toggleVisibility:S,loadData:M,data:_,refreshData:g,handleSizeChange:O,handleCurrentChange:$,searchParams:F,deleteRows:z,toggleSwitch:D}=ke("/api/v1/admin/supplier"),r=V({supplier_name:"",interface_code:"",status:""}),k=V(!1),G=async()=>{k.value=!0;try{F.value={...r.value},await g()}catch(d){console.error("搜索失败:",d),ElMessage.error("搜索失败，请重试")}finally{k.value=!1}},L=()=>{r.value={supplier_name:"",interface_code:"",status:""},F.value={...r.value},g()};Z(()=>{M()});const j=(d,l)=>{z(d,[l.id])},q=d=>{z(d)};return(d,l)=>{const v=he,p=te,R=_e,b=ce,w=ue,U=fe,Q=me,W=pe,X=de,A=re,H=ne,o=we,B=Ce,J=oe,K=se,f=ie("permission");return h(),ee(le,null,[e(Ve,{ref_key:"editFormRef",ref:c,onRefresh:n(g)},null,8,["onRefresh"]),e(ae,{name:"fade"},{default:a(()=>[m(s("div",xe,[e(A,{class:"search-card",shadow:"never"},{header:a(()=>[s("div",Ee,[s("span",Se,[e(v,null,{default:a(()=>[e(n(x))]),_:1}),l[6]||(l[6]=i(" 供应商搜索 ",-1))]),e(p,{type:"text",onClick:n(S),class:"close-btn"},{default:a(()=>[e(v,null,{default:a(()=>[e(n(ge))]),_:1})]),_:1},8,["onClick"])])]),default:a(()=>[e(X,{model:r.value,"label-width":"100px",class:"search-form"},{default:a(()=>[e(W,{gutter:20},{default:a(()=>[e(w,{span:6},{default:a(()=>[e(b,{label:"供应商名称"},{default:a(()=>[e(R,{modelValue:r.value.supplier_name,"onUpdate:modelValue":l[0]||(l[0]=t=>r.value.supplier_name=t),placeholder:"请输入供应商名称",clearable:"","prefix-icon":"Search"},null,8,["modelValue"])]),_:1})]),_:1}),e(w,{span:6},{default:a(()=>[e(b,{label:"接口代码"},{default:a(()=>[e(R,{modelValue:r.value.interface_code,"onUpdate:modelValue":l[1]||(l[1]=t=>r.value.interface_code=t),placeholder:"请输入接口代码",clearable:"","prefix-icon":"Document"},null,8,["modelValue"])]),_:1})]),_:1}),e(w,{span:6},{default:a(()=>[e(b,{label:"状态"},{default:a(()=>[e(Q,{modelValue:r.value.status,"onUpdate:modelValue":l[2]||(l[2]=t=>r.value.status=t),placeholder:"请选择状态",clearable:"",style:{width:"100%"}},{default:a(()=>[e(U,{label:"启用",value:1}),e(U,{label:"禁用",value:0})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(w,{span:6},{default:a(()=>[e(b,null,{default:a(()=>[s("div",Fe,[e(p,{type:"primary",onClick:G,loading:k.value},{default:a(()=>[e(v,null,{default:a(()=>[e(n(x))]),_:1}),l[7]||(l[7]=i(" 搜索 ",-1))]),_:1},8,["loading"]),e(p,{onClick:L},{default:a(()=>[e(v,null,{default:a(()=>[e(n(N))]),_:1}),l[8]||(l[8]=i(" 重置 ",-1))]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})],512),[[ve,n(P)]])]),_:1}),s("div",ze,[m(e(p,{icon:n(N),onClick:n(g),color:"#40485b"},null,8,["icon","onClick"]),[[f,"supplier:list"]]),m((h(),C(p,{type:"primary",icon:n(be),onClick:E},{default:a(()=>[...l[9]||(l[9]=[i("添加",-1)])]),_:1},8,["icon"])),[[f,"supplier:add"]]),m((h(),C(p,{type:"danger",disabled:!n(I),onClick:l[3]||(l[3]=t=>q("/api/v1/admin/supplier/delete"))},{default:a(()=>[...l[10]||(l[10]=[i("删除",-1)])]),_:1},8,["disabled"])),[[f,"supplier:delete"]]),l[11]||(l[11]=s("div",{class:"table-statistics"},[s("span",{class:"stat-item stat-highlight"},"剩余预付=预付总额-可提余额；（每日结算：供应商群组内输入指令->供应商结算）")],-1)),s("div",De,[e(H,{class:"ml-4"},{default:a(()=>[e(p,{icon:n(x),onClick:n(S)},null,8,["icon","onClick"])]),_:1})])]),s("div",Re,[e(J,{data:n(_).data,border:"",stripe:"","max-height":"600",style:{width:"100%"},onSelectionChange:n(T)},{default:a(()=>[e(o,{type:"selection",width:"40"}),e(o,{prop:"supplier_name",label:"供应商名称",align:"center","min-width":"150"}),e(o,{prop:"interface_code",label:"接口代码",align:"center","min-width":"150"}),e(o,{label:"状态",align:"center","min-width":"90"},{default:a(({row:t})=>[e(B,{modelValue:t.status,"onUpdate:modelValue":u=>t.status=u,"active-value":1,"inactive-value":0,onChange:u=>n(D)("/api/v1/admin/supplier/status-switch",t.id,Number(u))},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(o,{label:"预付检验",align:"center","min-width":"90"},{default:a(({row:t})=>[e(B,{modelValue:t.prepayment_check,"onUpdate:modelValue":u=>t.prepayment_check=u,"active-value":1,"inactive-value":0,onChange:u=>n(D)("/api/v1/admin/supplier/prepay-check",t.id,Number(u))},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(o,{prop:"prepayment_total",label:"预付总额(元)",align:"center","min-width":"120"},{default:a(({row:t})=>[i(y((t.prepayment_total/100).toFixed(2)),1)]),_:1}),e(o,{prop:"prepayment_remaining",label:"剩余预付(元)",align:"center","min-width":"120"},{default:a(({row:t})=>[i(y((t.prepayment_remaining/100).toFixed(2)),1)]),_:1}),e(o,{prop:"withdrawable_balance",label:"可提余额(元)",align:"center","min-width":"120"},{default:a(({row:t})=>[i(y((t.withdrawable_balance/100).toFixed(2)),1)]),_:1}),e(o,{prop:"today_receipt",label:"今日收款(元)",align:"center","min-width":"120"},{default:a(({row:t})=>[i(y((t.today_receipt/100).toFixed(2)),1)]),_:1}),e(o,{prop:"remark",label:"备注",align:"center","min-width":"150","show-overflow-tooltip":""}),e(o,{prop:"telegram_chat_id",label:"供应商群组ID",align:"center","min-width":"150"}),e(o,{label:"操作",align:"center",fixed:"right","min-width":"200"},{default:a(t=>[m((h(),C(p,{size:"small",onClick:u=>E(t.row)},{default:a(()=>[...l[12]||(l[12]=[i("编辑",-1)])]),_:1},8,["onClick"])),[[f,"supplier:edit"]]),m((h(),C(p,{size:"small",type:"danger",onClick:u=>j("/api/v1/admin/supplier/delete",t.row)},{default:a(()=>[...l[13]||(l[13]=[i("删除",-1)])]),_:1},8,["onClick"])),[[f,"supplier:delete"]])]),_:1})]),_:1},8,["data","onSelectionChange"])]),s("div",Ue,[s("div",Be,[e(K,{"current-page":n(_).current_page,"onUpdate:currentPage":l[4]||(l[4]=t=>n(_).current_page=t),"page-size":n(_).page_size,"onUpdate:pageSize":l[5]||(l[5]=t=>n(_).page_size=t),"page-sizes":[10,50,100,200],background:!0,"prev-text":"上一页","next-text":"下一页",layout:"total, sizes, prev, pager, next, jumper",total:n(_).page_total,onSizeChange:n(O),onCurrentChange:n($)},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])])],64)}}}),We=ye(Ne,[["__scopeId","data-v-92b04a30"]]);export{We as default};
//# sourceMappingURL=home-DNSpUB9z.js.map
